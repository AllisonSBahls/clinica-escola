
<script src='js/main.min.js'></script>
<script src='js/interaction.min.js'></script>
<script src='js/calendar.min.js'></script>
<script src='js/locales/pt-br.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'pt-br',
            plugins: ['interaction', 'dayGrid'],
            //defaultDate: '2019-04-12',
            editable: true,
            
            eventLimit: true, // allow "more" link when too many events
            events: [
                '<% if (consultation.length > 0) {%>',
                '<% for (var i = 0; i < consultation.length; i++) {%>',
                {
                    id: '<%= consultation[i].id  %>',
                    title: '<%= consultation[i].consultPatient.name%>',
                    start: '<%= moment(consultation[i].dateStart).format()  %>',
                    end: '<%= moment(consultation[i].dateEnd).add(4, "hours").format()  %>',
                    extendedProps: {
                        trainee: '<%= consultation[i].consultTraineeId %>',
                        secretary: '<%= consultation[i].consultSecretaryId  %>',
                    },
                    textColor: '#fff',
                },
                '<% } %>',
                '<% } %>',
            ],

            eventClick: function (info) {
                info.jsEvent.preventDefault();
                $('#viewConsult #id').text(info.event.id);
                $('#viewConsult #patient').text(info.event.title);
                $('#viewConsult #dateStart').text(info.event.start.toLocaleString());
                $('#viewConsult #trainee').text(info.event.extendedProps.trainee);
                $('#viewConsult #secretary').text(info.event.extendedProps.secretary);
                $('#viewConsult').modal('show');
            },

            selectable: true,
            select: function (info) {
                // alert('selected ' + info.start.toLocaleString());
                $('#register #dateStart').val(info.start.toLocaleString());
                $('#viewConsultDashboard #dateConsult').val(info.start.toLocaleString());
                $('#register').modal('show');
            },
        
        });

        calendar.render();
    });
    
</script>