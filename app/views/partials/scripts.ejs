<!-- Argon Scripts -->
<!-- Core -->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<!-- Optional JS -->
<!-- <script src="vendor/chart.js/dist/Chart.min.js"></script> -->
<!-- <script src="vendor/chart.js/dist/Chart.extension.js"></script> -->
<!-- Argon JS -->
<!-- <script src="js/argon.min.js?v=1.0.0"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script> --> -->

<script src='js/main.min.js'></script>
<script src='js/interaction.min.js'></script>
<script src='js/calendar.min.js'></script>
<script src='js/locales/pt-br.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'pt-br',
            plugins: ['interaction', 'dayGrid'],
            //defaultDate: '2019-04-12',
            editable: true,
            eventLimit: true, // allow "more" link when too many events
            events: [
                '<% if (consultation.length > 0) {%>',
                '<% for (var i = 0; i < consultation.length; i++) {%>',
                {
                    id: '<%= consultation[i].id  %>',
                    title: '<%= consultation[i].consultPatient.name  %>',
                    start: '<%= moment(consultation[i].dateStart).add(4, "hours").format()  %>',
                    end: '<%= moment(consultation[i].dateEnd).add(4, "hours").format()  %>',
                    extendedProps: {
                        trainee: '<%= consultation[i].consultTrainee.name  %>',
                        secretary: '<%= consultation[i].consultSecretary.name  %>',
                    },

                },

                '<% } %>',
                '<% } %>',
            ],
            eventClick: function (info) {
                info.jsEvent.preventDefault();
                $('#viewConsult #id').text(info.event.id);
                $('#viewConsult #patient').text(info.event.title);
                $('#viewConsult #dateStart').text(info.event.start.toLocaleString());
                $('#viewConsult #trainee').text(info.event.extendedProps.trainee);
                $('#viewConsult #secretary').text(info.event.extendedProps.secretary);
                $('#viewConsult').modal('show');
            },

            selectable: true,
            select: function (info) {
                // alert('selected ' + info.start.toLocaleString());
                $('#register #dateStart').val(info.start.toLocaleString());

                $('#register').modal('show');
            }
        });

        calendar.render();
    });

</script>